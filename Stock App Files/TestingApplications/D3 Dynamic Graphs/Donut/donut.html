<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Donut D3</title>

        <!-- D3  -->
        <script src="https://d3js.org/d3.v3.js"></script>

        <!-- Other JS -->
        <script src="donut.js"></script>

        <!-- Styling -->
        <link href="donut.css" rel="stylesheet">

        <style>
            body {
                background-color: #1B1F2A;
                width: 100%;
                font-family: 'Roboto', sans-serif;
                height: 100%;
            }

            .widget {
                margin: 0 auto;
                width:350px;
                margin-top:50px;
                background-color: #222D3A;
                border-radius: 5px;
                box-shadow: 0px 0px 1px 0px #06060d;

            }

            .header{
                background-color: #29384D;
                height:40px;
                color:#929DAF;
                text-align: center;
                line-height: 40px;
                border-top-left-radius: 7px;
                border-top-right-radius: 7px;
                font-weight: 400;
                font-size: 1.5em;
                text-shadow: 1px 1px #06060d;
            }

            .chart-container{
                padding:25px;
            }

            .shadow {
                -webkit-filter: drop-shadow( 0px 3px 3px rgba(0,0,0,.5) );
                filter: drop-shadow( 0px 3px 3px rgba(0,0,0,.5) );
            }

            .firstStockDiv, .firstStockPercentageDiv, .secondStockDiv, .secondStockPercentageDiv,
            .thirdStockDiv, .thirdStockPercentageDiv, .fourthStockDiv, .fourthStockPercentageDiv {
                display: inline-block;
            }
        </style>

    </head>
    <body>

        <!-- Inputs for first stock symbol -->
        <div class="firstStockDiv">
            <label for="firstStock"></label>
            <input type="text" id="firstStock" placeholder="Enter Stock Symbol">
        </div>
        <div class="firstStockPercentageDiv">
            <label for="firstStockPercentage"></label>
            <input type="text" id="firstStockPercentage" placeholder="Enter First Stock Percentage">
        </div>
        <br>

        <!-- Inputs for Second stock symbol -->
        <div class="secondStockDiv">
            <label for="secondStock"></label>
            <input type="text" id="secondStock" placeholder="Enter Stock Symbol">
        </div>
        <div class="secondStockPercentageDiv">
            <label for="secondStockPercentage"></label>
            <input type="text" id="secondStockPercentage" placeholder="Enter Second Stock Percentage">
        </div>
        <br>

        <!-- Inputs for Third stock symbol -->
        <div class="thirdStockDiv">
            <label for="thirdStock"></label>
            <input type="text" id="thirdStock" placeholder="Enter Stock Symbol">
        </div>
        <div class="thirdStockPercentageDiv">
            <label for="thirdStockPercentage"></label>
            <input type="text" id="thirdStockPercentage" placeholder="Enter Third Stock Percentage">
        </div>
        <br>

        <!-- Inputs for Fourth stock symbol -->
        <div class="fourthStockDiv">
            <label for="fourthStock"></label>
            <input type="text" id="fourthStock" placeholder="Enter Stock Symbol">
        </div>
        <div class="fourthStockPercentageDiv">
            <label for="fourthStockPercentage"></label>
            <input type="text" id="fourthStockPercentage" placeholder="Enter Fourth Stock Percentage">
        </div>

        <!-- Button that updates Donut Graph -->
        <br>
        <button id="updateDonut" onclick="updateDonut()" style="margin-top: 10px"> Update </button>


        <!-- Donut -->
        <div class="widget">
            <div class="header">Browser Market Share</div>
            <div id="chart" class="chart-container"></div>
        </div>

        <!-- D3 -->
        <script>

            var firstStock = null;
            var firstStockPercentage = null;
            var secondStock = null;
            var secondStockPercentage = null;
            var thirdStock = null;
            var thirdStockPercentage = null;
            var fourthStock = null;
            var fourthStockPercentage = null;

            // on owned stock Symbol button Click
            function updateDonut() {

                // first stock
                firstStock = document.getElementById("firstStock").value;
                console.log("Search for Stock input: " + firstStock);
                firstStockPercentage = document.getElementById("firstStockPercentage").value;
                console.log("Search for Stock input: " + firstStockPercentage);

                // second stock
                secondStock = document.getElementById("secondStock").value;
                console.log("Search for Stock input: " + secondStock);
                secondStockPercentage = document.getElementById("secondStockPercentage").value;
                console.log("Search for Stock input: " + secondStockPercentage);

                // third stock
                thirdStock = document.getElementById("thirdStock").value;
                console.log("Search for Stock input: " + thirdStock);
                thirdStockPercentage = document.getElementById("thirdStockPercentage").value;
                console.log("Search for Stock input: " + thirdStockPercentage);

                // fourth stock
                fourthStock = document.getElementById("fourthStock").value;
                console.log("Search for Stock input: " + fourthStock);
                fourthStockPercentage = document.getElementById("fourthStockPercentage").value;
                console.log("Search for Stock input: " + fourthStockPercentage);
            }

            var dataset = [
                { name: 'EXTR', percent: 39.10 },
                { name: 'Chrome', percent: 32.51 },
                { name: 'Safari', percent: 13.68 },
                { name: 'Firefox', percent: 8.71 }
            ];

            var pie=d3.layout.pie()
                .value(function(d){return d.percent})
                .sort(null)
                .padAngle(.03);

            var w=300,h=300;

            var outerRadius=w/2;
            var innerRadius=100;

            var color = d3.scale.category10();

            var arc=d3.svg.arc()
                .outerRadius(outerRadius)
                .innerRadius(innerRadius);

            var svg=d3.select("#chart")
                .append("svg")
                .attr({
                    width:w,
                    height:h,
                    class:'shadow'
                }).append('g')
                .attr({
                    transform:'translate('+w/2+','+h/2+')'
                });
            var path=svg.selectAll('path')
                .data(pie(dataset))
                .enter()
                .append('path')
                .attr({
                    d:arc,
                    fill:function(d,i){
                        return color(d.data.name);
                    }
                });

            path.transition()
                .duration(1000)
                .attrTween('d', function(d) {
                    var interpolate = d3.interpolate({startAngle: 0, endAngle: 0}, d);
                    return function(t) {
                        return arc(interpolate(t));
                    };
                });


            var restOfTheData=function(){
                var text=svg.selectAll('text')
                    .data(pie(dataset))
                    .enter()
                    .append("text")
                    .transition()
                    .duration(200)
                    .attr("transform", function (d) {
                        return "translate(" + arc.centroid(d) + ")";
                    })
                    .attr("dy", ".4em")
                    .attr("text-anchor", "middle")
                    .text(function(d){
                        return d.data.percent+"%";
                    })
                    .style({
                        fill:'#fff',
                        'font-size':'10px'
                    });

                var legendRectSize=20;
                var legendSpacing=7;
                var legendHeight=legendRectSize+legendSpacing;


                var legend=svg.selectAll('.legend')
                    .data(color.domain())
                    .enter()
                    .append('g')
                    .attr({
                        class:'legend',
                        transform:function(d,i){
                            //Just a calculation for x & y position
                            return 'translate(-35,' + ((i*legendHeight)-65) + ')';
                        }
                    });
                legend.append('rect')
                    .attr({
                        width:legendRectSize,
                        height:legendRectSize,
                        rx:20,
                        ry:20
                    })
                    .style({
                        fill:color,
                        stroke:color
                    });

                legend.append('text')
                    .attr({
                        x:30,
                        y:15
                    })
                    .text(function(d){
                        return d;
                    }).style({
                    fill:'#929DAF',
                    'font-size':'14px'
                });
            };

            setTimeout(restOfTheData,1000);

        </script>

    </body>
</html>